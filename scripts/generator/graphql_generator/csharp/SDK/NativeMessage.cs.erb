namespace <%= namespace %>.SDK {
    using System;
    using System.Collections.Generic;
    using System.Runtime.InteropServices;
    using <%= namespace %>.MiniJSON;

    public class NativeMessage {

        [DllImport ("__Internal")]
        private static extern void _RespondToNativeMessage(string identifier, string message);

        public string Identifier;
        public string Content;

        public static NativeMessage CreateFromJSON(string jsonString) {
            var dict = (Dictionary<string, object>) Json.Deserialize(jsonString);
            return new NativeMessage((string) dict["Identifier"], (string) dict["Content"]);
        }

        public NativeMessage(string identifier, string content) {
            Identifier = identifier;
            Content = content;
        }

        public void Respond(string message) {
            #if !SHOPIFY_MONO_UNIT_TEST
            _RespondToNativeMessage(Identifier, message);
            #endif
        }
    }
}
