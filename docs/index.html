<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Shopify SDK for Unity: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Shopify SDK for Unity
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Shopify SDK for Unity Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity lets you add commerce features to games made with the <a href="//unity3d.com">Unity</a> game engine. You can use it to connect in-game purchase experiences with physical products in <a class="el" href="namespace_shopify.html">Shopify</a>.</p>
<p>You can use the <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity to:</p>
<ul>
<li>fetch information about a single product or a collection of products in <a class="el" href="namespace_shopify.html">Shopify</a></li>
<li>create an in-game shopping cart where customers can select product options and quantities</li>
<li>generate a checkout for a single product or an entire cart.</li>
</ul>
<h2>Getting started</h2>
<p>If you want to learn more about how this SDK works with Unity, then see the <a href="//help.shopify.com/api/sdks/custom-storefront/unity-buy-sdk/getting-started">Shopify SDK for Unity tutorial</a>. </p><h1>Examples</h1>
<p>This guide contains code examples that show different ways that you can use the <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity.</p>
<p>The <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity queries <a class="el" href="namespace_shopify.html">Shopify</a>'s <a href="https://help.shopify.com/api/storefront-api">Storefront API</a>, which is a <a href="http://graphql.org">GraphQL</a> API. GraphQL APIs accept queries that define the data that you want to retrieve. The <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity lets you query various data from <a class="el" href="namespace_shopify.html">Shopify</a>, including store information, checkout URLs, products, and collections.</p>
<h2>Table of contents</h2>
<ul>
<li><a href="#before-you-begin">Before you begin</a></li>
<li><a href="#supported-build-targets">Supported build targets</a></li>
<li><a href="#initialize-the-sdk">Initialize the SDK</a></li>
<li><a href="#query-products">Query Products</a></li>
<li><a href="#query-collections">Query Collections</a></li>
<li><a href="#build-a-cart">Build a cart</a></li>
<li><a href="#build-a-cart-based-on-selected-options">Build a cart based on selected options</a></li>
<li><a href="#checkout-with-a-checkout-link">Checkout with a checkout link</a></li>
<li><a href="#checkout-with-a-web-view">Checkout with a Web View</a></li>
<li><a href="#checkout-with-native-pay-apple-pay--android-pay">Checkout with Native Pay (Apple Pay / Android Pay)</a></li>
<li><a href="#custom-queries">Custom queries</a></li>
</ul>
<h2>Before you begin</h2>
<p>Before you can start using the <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity, you need:</p>
<ul>
<li>a <a class="el" href="namespace_shopify.html">Shopify</a> store with at least one product. If you do not have a <a class="el" href="namespace_shopify.html">Shopify</a> store you have two options:<ul>
<li><a href="https://www.shopify.ca/partners">Sign up as a Shopify Partner to create a test store</a></li>
<li>Start testing the SDK using our test store. (domain and access token listed below)</li>
</ul>
</li>
<li><a href="https://help.shopify.com/api/storefront-api/getting-started#obtaining-a-storefront-access-token">a storefront access token for your app</a></li>
<li><a href="https://github.com/Shopify/unity-buy-sdk/blob/master/README.md#using-the-shopify-sdk-for-unity">to install the Shopify SDK for Unity into your Unity project</a></li>
</ul>
<h2>Supported build targets</h2>
<p>See <a href="README.md#supported-build-targets">Build Target Requirements</a> for information on setting up the SDK on iOS and Android</p>
<h2>Initialize the SDK</h2>
<p>This code example initializes the SDK. The <code>ShopifyBuy.Init</code> method takes two arguments. The first is a storefront access token to communicate with the Storefront API. The second is the domain name of your shop.</p>
<div class="fragment"><div class="line"><span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line"><span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">ShopifyBuy.Init(accessToken, shopDomain);</div></div><!-- fragment --><p>After you initialize the SDK, you can use <code>ShopifyBuy.Client()</code> to query <a class="el" href="namespace_shopify.html">Shopify</a>. You need to initialize the SDK only once.</p>
<h2>Query Products</h2>
<p>The following example shows how to query two pages of products in your <a class="el" href="namespace_shopify.html">Shopify</a> store:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    <span class="comment">// Init only needs to be called once</span></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    <span class="comment">// Queries one page of products</span></div><div class="line">    ShopifyBuy.Client().products((products, error, after) =&gt; {</div><div class="line">        <span class="keywordflow">if</span> (error != null) {</div><div class="line">            Debug.Log(error.Description);</div><div class="line"></div><div class="line">            <span class="keywordflow">switch</span>(error.Type) {</div><div class="line">            <span class="comment">// An HTTP error is actually Unity&#39;s WWW.error</span></div><div class="line">            <span class="keywordflow">case</span> ShopifyError.ErrorType.HTTP:</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">                <span class="comment">// Although it&#39;s unlikely, an invalid GraphQL query might be sent.</span></div><div class="line">                <span class="comment">// Report an issue to https://github.com/shopify/unity-buy-sdk/issues</span></div><div class="line">            <span class="keywordflow">case</span> ShopifyError.ErrorType.GraphQL:</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            };</div><div class="line">        } <span class="keywordflow">else</span> {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Here is the first page of products:&quot;</span>);</div><div class="line"></div><div class="line">            <span class="comment">// products is a List&lt;Product&gt;</span></div><div class="line">            <span class="keywordflow">foreach</span>(Product product <span class="keywordflow">in</span> products) {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;Product Title: &quot;</span> + product.title());</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;Product Description: &quot;</span> + product.descriptionHtml());</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;--------&quot;</span>);</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (after != null) {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;Here is the second page of products:&quot;</span>);</div><div class="line"></div><div class="line">                <span class="comment">// Queries second page of products, as after is passed</span></div><div class="line">                ShopifyBuy.Client().products((products2, error2, after2) =&gt; {</div><div class="line">                    <span class="keywordflow">foreach</span>(Product product <span class="keywordflow">in</span> products2) {</div><div class="line">                        Debug.Log(<span class="stringliteral">&quot;Product Title: &quot;</span> + product.title());</div><div class="line">                        Debug.Log(<span class="stringliteral">&quot;Product Description: &quot;</span> + product.descriptionHtml());</div><div class="line">                        Debug.Log(<span class="stringliteral">&quot;--------&quot;</span>);</div><div class="line">                    }</div><div class="line">                }, after: after);</div><div class="line">            } <span class="keywordflow">else</span> {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;There was only one page of products.&quot;</span>);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><h2>Query Collections</h2>
<p>The following example shows how to query one page of collections in your <a class="el" href="namespace_shopify.html">Shopify</a> store:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    <span class="comment">// Queries one page of collections</span></div><div class="line">    ShopifyBuy.Client().collections((collections, error, after) =&gt; {</div><div class="line">        <span class="keywordflow">if</span> (error != null) {</div><div class="line">            Debug.Log(error.Description);</div><div class="line"></div><div class="line">            <span class="keywordflow">switch</span>(error.Type) {</div><div class="line">            <span class="comment">// An HTTP error is actually Unity&#39;s WWW.error</span></div><div class="line">            <span class="keywordflow">case</span> ShopifyError.ErrorType.HTTP:</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            <span class="comment">// It&#39;s unlikely but it may be that an invalid GraphQL query was sent.</span></div><div class="line">            <span class="comment">// Report an issue to https://github.com/shopify/unity-buy-sdk/issues</span></div><div class="line">            <span class="keywordflow">case</span> ShopifyError.ErrorType.GraphQL:</div><div class="line">                <span class="keywordflow">break</span>;</div><div class="line">            };</div><div class="line"></div><div class="line">        } <span class="keywordflow">else</span> {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Loaded the first page of collections:&quot;</span>);</div><div class="line"></div><div class="line">            <span class="comment">// collections is a List&lt;Collection&gt;</span></div><div class="line">            <span class="keywordflow">foreach</span>(Collection collection <span class="keywordflow">in</span> collections) {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;Collection title: &quot;</span> + collection.title());</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;Collection updated at: &quot;</span> + collection.updatedAt());</div><div class="line"></div><div class="line">                List&lt;Product&gt; products = (List&lt;Product&gt;) collection.products();</div><div class="line"></div><div class="line">                <span class="keywordflow">foreach</span>(Product product <span class="keywordflow">in</span> products) {</div><div class="line">                    Debug.Log(<span class="stringliteral">&quot;Collection contains a product with the following id: &quot;</span> + product.id());</div><div class="line">                }</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (after != null) {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;We also have a second page of products&quot;</span>);</div><div class="line">            } <span class="keywordflow">else</span> {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;We don&#39;t have a second page of products&quot;</span>);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><p>In this example, if you called <code>product.title()</code> then an exception would be thrown. Since the <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity is built on GraphQL queries, when <code>collections</code> are queried using this method only <code>id</code> is queried on <code>Product</code>. To learn which fields are queried using this method, see <code>DefaultQueries.cs</code>.</p>
<p>You can also make more complex requests using <a href="#custom-queries">custom queries</a>.</p>
<h2>Build a cart</h2>
<p>The following example shows how to create a cart and add line items to the cart using product variants:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    ShopifyBuy.Client().products((products, error, after) =&gt; {</div><div class="line">        Cart cart = ShopifyBuy.Client().Cart();</div><div class="line"></div><div class="line">        List&lt;ProductVariant&gt; firstProductVariants = (List&lt;ProductVariant&gt;) products[0].variants();</div><div class="line">        ProductVariant firstProductFirstVariant = firstProductVariants[0];</div><div class="line"></div><div class="line">        <span class="comment">// The following example adds a line item using the first products first variant.</span></div><div class="line">        <span class="comment">// In this case, the cart will have 3 copies of the variant.</span></div><div class="line">        cart.LineItems.AddOrUpdate(firstProductFirstVariant, 3);</div><div class="line"></div><div class="line">        <span class="comment">// The following will output the variant id which was setup using the first product variant</span></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;First line item&#39;s variant id is: &quot;</span> + cart.LineItems.All()[0].VariantId);</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><p>If you want to adjust or change quantity on a line item, then you can call <code>AddOrUpdate</code> again with the new quantity. For example, if you want to adjust the quantity for <code>firstProductFirstVariant</code> to 1 in the code above, then you could call:</p>
<div class="fragment"><div class="line">cart.LineItems.AddOrUpdate(firstProductFirstVariant, 1);</div></div><!-- fragment --><p>To delete a line item do the following: </p><div class="fragment"><div class="line">cart.LineItems.Delete(firstProductFirstVariant);</div></div><!-- fragment --><p>To get a line item do the following: </p><div class="fragment"><div class="line">LineItemInput lineItem = cart.LineItems.Get(firstProductFirstVariant);</div></div><!-- fragment --><h3>Build a cart based on selected options</h3>
<p>In <a class="el" href="namespace_shopify.html">Shopify</a>, a product can have many options. These options map to <b>variants</b> of a product. The following example shows how to create line items in a cart based on selected product variants:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    ShopifyBuy.Client().products((products, error, after) =&gt; {</div><div class="line">        Cart cart = ShopifyBuy.Client().Cart();</div><div class="line"></div><div class="line">        Product firstProduct = products[0];</div><div class="line"></div><div class="line">        List&lt;ProductOption&gt; options = firstProduct.options();</div><div class="line"></div><div class="line">        <span class="comment">// Output all options for this product</span></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;Options:\n-------&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">foreach</span>(ProductOption option <span class="keywordflow">in</span> options) {</div><div class="line">            <span class="comment">// Options have possible values</span></div><div class="line">            <span class="keywordflow">foreach</span>(<span class="keywordtype">string</span> value <span class="keywordflow">in</span> option.values()) {</div><div class="line">                <span class="comment">// Each option has a name such as Color and multiple values for Color</span></div><div class="line">                Debug.Log(option.name() + <span class="stringliteral">&quot;: &quot;</span> + value);</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;-------&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">// The following creates a dictionary where keys are option names and values are option values.</span></div><div class="line">        <span class="comment">// You might, for instance, have drop downs where users can select relevant options.</span></div><div class="line">        Dictionary&lt;string,string&gt; selectedOptions = <span class="keyword">new</span> Dictionary&lt;string,string&gt;() {</div><div class="line">            {<span class="stringliteral">&quot;Size&quot;</span>, <span class="stringliteral">&quot;M&quot;</span>},</div><div class="line">            {<span class="stringliteral">&quot;Color&quot;</span>, <span class="stringliteral">&quot;Ash&quot;</span>}</div><div class="line">        };</div><div class="line"></div><div class="line">        <span class="comment">// Create a line item based on the selected options for a product</span></div><div class="line">        cart.LineItems.AddOrUpdate(firstProduct, selectedOptions, 1);</div><div class="line"></div><div class="line">        <span class="comment">// The following will output the variant id which was selected by the above options</span></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;First line item&#39;s variant id is: &quot;</span> + cart.LineItems.All()[0].VariantId);</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><p>If you want to <code>Delete</code> or <code>Get</code> a line item, then use the following:</p>
<div class="fragment"><div class="line">cart.LineItems.Get(firstProduct, selectedOptions);</div><div class="line">cart.LineItems.Delete(firstProduct, selectedOptions);</div></div><!-- fragment --><h2>Checkout with a checkout link</h2>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    ShopifyBuy.Client().products((products, error, after) =&gt; {</div><div class="line">        Cart cart = ShopifyBuy.Client().Cart();</div><div class="line"></div><div class="line">        List&lt;ProductVariant&gt; firstProductVariants = (List&lt;ProductVariant&gt;) products[0].variants();</div><div class="line">        ProductVariant firstProductFirstVariant = firstProductVariants[0];</div><div class="line"></div><div class="line">        <span class="comment">// The following example adds a line item using the first products first variant.</span></div><div class="line">        <span class="comment">// In this case, the cart will have 3 copies of the variant.</span></div><div class="line">        cart.LineItems.AddOrUpdate(firstProductFirstVariant, 3);</div><div class="line"></div><div class="line">        <span class="comment">// Checkout with the url in the Device Browser</span></div><div class="line">        cart.GetWebCheckoutLink(</div><div class="line">            success: (link) =&gt; {</div><div class="line">                Application.OpenURL(link);</div><div class="line">            },</div><div class="line">            failure: (checkoutError) =&gt; {</div><div class="line">                Debug.Log(checkoutError.Description);</div><div class="line">            }</div><div class="line">        );</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><h2>Checkout with a Web View</h2>
<p>After creating an instance of <code>Cart</code> and adding items to it, you can use the <code>CheckoutWithWebView</code> method to start a web view that contains the checkout for the cart.</p>
<p><code>CheckoutWithWebView</code> takes in 3 callback parameters:</p>
<ul>
<li><code>CheckoutSuccessCallback</code> is called when the user has completed a checkout successfully.</li>
<li><code>CheckoutCancelCallback</code> is called when the user cancels out of the checkout.</li>
<li><code>CheckoutFailureCallback</code> is called when an error was encountered during the web checkout. The callback will pass an instance of <code>ShopifyError</code> describing the issue.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// Sample code for adding some product variants to your cart.</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">ShopifyBuy.Client().products((products, error, after) =&gt; {</div><div class="line">    var cart = ShopifyBuy.Client().Cart();</div><div class="line">    var firstProduct = products[0];</div><div class="line">    var firstProductVariants = (List&lt;ProductVariant&gt;) firstProduct.variants();</div><div class="line">    ProductVariant productVariantToCheckout = firstProductVariants[0];</div><div class="line"></div><div class="line">    cart.LineItems.AddOrUpdate(productVariantToCheckout, 1);</div><div class="line"></div><div class="line">    <span class="comment">// Launches the web view checkout experience overlaid on top of your game.</span></div><div class="line">    cart.CheckoutWithWebView(</div><div class="line">        success: () =&gt; {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;User finished purchase/checkout!&quot;</span>);</div><div class="line">        },</div><div class="line">        cancelled: () =&gt; {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;User cancelled out of the web checkout.&quot;</span>);</div><div class="line">        },</div><div class="line">        failure: (e) =&gt; {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Something bad happened - Error: &quot;</span> + e);</div><div class="line">        }</div><div class="line">    );</div><div class="line">});</div></div><!-- fragment --><h2>Checkout with Native Pay (Apple Pay / Android Pay)</h2>
<p>You can allow users to pay with Apple Pay or Android Pay (coming soon), depending on the device OS, providing a seamless checkout experience.</p>
<p>To determine whether the user is able to make a payment with Native Pay, you can use the <code>CanCheckoutWithNativePay</code> method. If the user has this capability, then you can use <code>CheckoutWithNativePay</code> to present the native pay authentication interface to the user. If they do not, then you can accept payment using <a href="#checkout-with-a-web-view">Web View Checkout</a>.</p>
<p><code>CheckoutWithNativePay</code> takes in 4 parameters:</p>
<ul>
<li><code>key</code><ul>
<li><b>On iOS</b> is the Merchant ID of your application found on your <a href="https://developer.apple.com/library/content/ApplePay_Guide/Configuration.html">Apple Developer Portal</a>.</li>
<li><b>On Android</b> is a Base64-encoded public key found on your <a class="el" href="namespace_shopify.html">Shopify</a> admin page. To locate the key, navigate to <em>Admin</em> &gt; <em>Apps</em> &gt; <em>Manage private apps</em> &gt; _{Your private app}_ &gt; <em>Storefront API</em> &gt; <em>Configure Mobile Buy SDK settings (optional)</em> &gt; <em>MOBILE BUY SDK (ANDROID)</em>.</li>
</ul>
</li>
<li><code>CheckoutSuccessCallback</code> is called when the user has completed a checkout successfully.</li>
<li><code>CheckoutCancelCallback</code> is called when the user cancels out of the checkout.</li>
<li><code>CheckoutFailureCallback</code> is called when an error was encountered during the checkout. The callback will be passed an instance of <code>ShopifyError</code> describing the issue.</li>
</ul>
<div class="fragment"><div class="line">// Sample code for adding some product variants to your cart.</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">ShopifyBuy.Client().products((products, error) =&gt; {</div><div class="line">    var cart = ShopifyBuy.Client().Cart();</div><div class="line">    var firstProduct = products[0];</div><div class="line">    var firstProductVariants = (List&lt;ProductVariant&gt;) firstProduct.variants();</div><div class="line">    ProductVariant productVariantToCheckout = firstProductVariants[0];</div><div class="line"></div><div class="line">    cart.LineItems.AddOrUpdate(productVariantToCheckout, 1);</div><div class="line"></div><div class="line">    var key = null;</div><div class="line">    #if UNITY_IOS</div><div class="line">    key = &quot;com.merchant.id&quot;;</div><div class="line">    #elif UNITY_ANDROID</div><div class="line">    key = &quot;BL9QiRljozDhgfyfVHoK+l1l98fBY0x/in0rCYJxmTfnzJDWsX1+8l4HEa4LO0WeKQlYtuk8zcJtzimTMhr1UL8=&quot;;</div><div class="line">    #endif</div><div class="line"></div><div class="line">    // Check to see if the user can make a payment through Apple Pay</div><div class="line">    cart.CanCheckoutWithNativePay((isNativePayAvailable) =&gt; {</div><div class="line">        if (isNativePayAvailable) {</div><div class="line">            cart.CheckoutWithNativePay(</div><div class="line">                key,</div><div class="line">                success: () =&gt; {</div><div class="line">                    Debug.Log(&quot;User finished purchase/checkout!&quot;);</div><div class="line">                },</div><div class="line">                cancelled: () =&gt; {</div><div class="line">                    Debug.Log(&quot;User cancelled out of the native checkout.&quot;);</div><div class="line">                },</div><div class="line">                failure: (e) =&gt; {</div><div class="line">                    Debug.Log(&quot;Something bad happened - Error: &quot; + e);</div><div class="line">                }</div><div class="line">            );</div><div class="line">        }</div><div class="line">    });</div><div class="line">});</div></div><!-- fragment --><h3>Additional build settings (Apple Pay only)</h3>
<p>To use Apple Pay, you must also enable <b>Background fetch</b> in the Player Settings:</p>
<ol type="1">
<li>In Unity, open <b>Player Settings</b>, and then click <em>Edit</em> &gt; <em>Project Settings</em> &gt; <em>Player</em>.</li>
<li>Select <b>Settings for iOS</b>.</li>
<li>Under <b>Other Settings</b>, set <b>Behavior in Background</b> to <b>Custom</b>.</li>
<li>Enable <b>Background fetch</b>.</li>
</ol>
<h3>Enabling native pay on your Store</h3>
<p>To enable native pay for your store through an app:</p>
<ol type="1">
<li>Follow <a href="https://help.shopify.com/manual/apps/private-apps#generate-credentials-from-the-shopify-admin">these instructions</a> to create a private app in your <a class="el" href="namespace_shopify.html">Shopify</a> admin page.</li>
</ol>
<ol type="1">
<li>Enable <em>Allow this app to access your storefront data using the Storefront API</em> flag in your private app configuration. <h3>Notes</h3>
</li>
</ol>
<p><code>CheckoutWithNativePay</code> will throw an exception if the device is unable to make a payment through Apple Pay. So it is essential that <code>CanCheckoutWithNativePay</code> is used.</p>
<h3>Errors</h3>
<p>On failure, you will receive a <code>ShopifyError</code>. There are 3 types of <code>ShopifyError</code> that you will have to handle:</p>
<ul>
<li><code>HTTP</code></li>
<li><code>NativePaymentProcessingError</code></li>
<li><code>GraphQL</code></li>
</ul>
<p><code>HTTP</code> errors will be thrown when there was an issue connecting or downloading to a required web server.</p>
<p><code>NativePaymentProcessingError</code></p>
<p>This error is thrown whenever something goes wrong on the native pay side of the checkout. It is unrecoverable and you should fall back to a different payment method, or allow the user to try going through the process again. The reasons for this error to be thrown depend on the platform:</p>
<ul>
<li><b>iOS:</b> will be thrown when Apple Pay fails to generate a token while trying to authenticate the user's card.</li>
<li><b>Android:</b> will be thrown for any unrecoverable Android Pay error that is prefixed with <code>ERROR_</code>, such as <em>service unavailable</em>, <em>unsupported country</em> or <em>authentication error</em>. You can see a full list of errors <a href="https://developers.google.com/android/reference/com/google/android/gms/wallet/WalletConstants">here</a>.</li>
</ul>
<p><code>GraphQL</code> error will be thrown when there is something wrong with the SDK. This error is unrecoverable and you should fall back to a different payment method.</p>
<div class="fragment"><div class="line">cart.CheckoutWithNativePay(</div><div class="line">    key,</div><div class="line">    success: () =&gt; {</div><div class="line">       Debug.Log(&quot;User finished purchase/checkout!&quot;);</div><div class="line">    },</div><div class="line">    cancelled: () =&gt; {</div><div class="line">        Debug.Log(&quot;User cancelled out of the native checkout.&quot;);</div><div class="line">    },</div><div class="line">    failure: (e) =&gt; {</div><div class="line">        switch(e.Type) {</div><div class="line">        case ShopifyError.ErrorType.HTTP:</div><div class="line">            // Let the user know that there is no internet connection</div><div class="line">            break;</div><div class="line">        default:</div><div class="line">            // Let the user know that checkout could not be completed</div><div class="line">            // Fallback to Web Checkout</div><div class="line">            break;</div><div class="line">        }</div><div class="line">    }</div><div class="line">);</div></div><!-- fragment --><h3>Extras</h3>
<p>You might want to optionally drive users to setup their payment cards with Apple Pay. You can do so by using <code>CanShowNativePaySetup</code> and <code>ShowNativePaySetup</code>. <code>CanShowNativePaySetup</code> lets you know whether the device supports this, and <code>ShowNativePaySetup</code> launches the native <code>Wallet</code> app prompting the user to set up his or her card.</p>
<h2>Custom queries</h2>
<p>The <a class="el" href="namespace_shopify.html">Shopify</a> SDK for Unity is built on top of <a class="el" href="namespace_shopify.html">Shopify</a>'s <a href="https://help.shopify.com/api/storefront-api">Storefront API</a>, which is a GraphQL Web API. In GraphQL, you send queries to the endpoint and receive back a JSON responses.</p>
<p>The following example shows a GraphQL query that retrieves a store's name and some details about its domain address:</p>
<div class="fragment"><div class="line">query {</div><div class="line">  shop {</div><div class="line">    name</div><div class="line">    primaryDomain {</div><div class="line">      url</div><div class="line">      host</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>When this query is sent to the Storefront API, the JSON response from the server looks like this:</p>
<div class="fragment"><div class="line">{</div><div class="line">  &quot;data&quot;: {</div><div class="line">    &quot;shop&quot;: {</div><div class="line">      &quot;name&quot;: &quot;graphql&quot;,</div><div class="line">      &quot;primaryDomain&quot;: {</div><div class="line">        &quot;url&quot;: &quot;https://unity-buy-sdk.myshopify.com&quot;,</div><div class="line">        &quot;host&quot;: &quot;unity-buy-sdk.myshopify.com&quot;</div><div class="line">      }</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>As you can see, the data output takes the same form as the query sent to the GraphQL endpoint. To learn more about how GraphQL handles queries and responses, see <a href="http://graphql.org">graphql.org</a>.</p>
<p>In the previous example, the queries for <code>products</code> and <code>collections</code> were made using client-side utility functions that create generic queries for the most common types of information. But you can also send custom queries to the Storefront API to access additional data. To learn more about how the Storefront API works, see <a href="https://help.shopify.com/api/storefront-api">the Storefront API documentation</a>.</p>
<p>The following example shows how to build a custom query in C# that matches the GraphQL query mentioned above. It retrieves the same information that was queried in the previous example:</p>
<ul>
<li>the shop's <code>name</code></li>
<li>the shop's <code>primaryDomain</code><ul>
<li><code>url</code></li>
<li><code>host</code></li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;b8d417759a62f7b342f3735dbe86b322&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;unity-buy-sdk.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    <span class="comment">// The following builds a custom query.</span></div><div class="line">    <span class="comment">// This example uses named parameters but these could be omitted.</span></div><div class="line">    ShopifyBuy.Client().Query(</div><div class="line">        <span class="comment">// Pass a lambda expression to &#39;buildQuery&#39;</span></div><div class="line">        <span class="comment">// The lambda receives a QueryRootQuery instance.</span></div><div class="line">        buildQuery: (query) =&gt; query</div><div class="line">            .shop(shopQuery =&gt; shopQuery</div><div class="line">                .name()</div><div class="line">                .primaryDomain(primaryDomainQuery =&gt; primaryDomainQuery</div><div class="line">                    .url()</div><div class="line">                    .host()</div><div class="line">                )</div><div class="line">            ),</div><div class="line">        callback: (result, error) =&gt; {</div><div class="line">            <span class="comment">// Results in a QueryRoot instance</span></div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Shop name: &quot;</span> + result.shop().name());</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Shop url: &quot;</span> + result.shop().primaryDomain().url());</div><div class="line">        }</div><div class="line">    );</div><div class="line">}</div></div><!-- fragment --><p>To create mutations, you can use <code>ShopifyBuy.Client().Mutation</code> in a similar way. </p>
</div></div><!-- contents -->
<address class="footer"><small>
    <a href="https://www.shopify.ca/">
        <img class="footer" height="50" src="https://camo.githubusercontent.com/10d580ddb06e6e6ff66ae43959842201195c6269/68747470733a2f2f63646e2e73686f706966792e636f6d2f73686f706966792d6d61726b6574696e675f6173736574732f6275696c64732f31392e302e302f73686f706966792d66756c6c2d636f6c6f722d626c61636b2e737667" alt="Shopify">
    </a>
</small></address>
