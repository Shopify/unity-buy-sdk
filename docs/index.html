<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unity Buy SDK: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unity Buy SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Unity Buy SDK Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Unity Buy SDK lets you add commerce features to games made with the <a href="//unity3d.com">Unity</a> game engine. You can use it to connect in-game purchase experiences with physical products in <a class="el" href="namespace_shopify.html">Shopify</a>.</p>
<p>You can use the Unity Buy SDK to:</p>
<ul>
<li>fetch information about a single product or a collection of products in <a class="el" href="namespace_shopify.html">Shopify</a></li>
<li>create an in-game shopping cart where customers can select product options and quantities</li>
<li>generate a checkout for a single product or an entire cart.</li>
</ul>
<h2>Getting started</h2>
<p>If you need to get API credentials and create a <a class="el" href="namespace_shopify.html">Shopify</a> store to use with the Unity Buy SDK, then see our <a href="//help.shopify.com/api/getting-started">general getting started guide</a>. If you want to learn more about how this SDK works with Unity, then see the <a href="//help.shopify.com/api/sdks/custom-storefront/unity-buy-sdk/getting-started">Unity Buy SDK tutorial</a>. </p><h1>Examples</h1>
<p>This file contains small code snippets which document different use cases for the Unity Buy SDK. The Unity Buy SDK queries <a class="el" href="namespace_shopify.html">Shopify</a>'s Storefront API. The Storefront API is a GraphQL API. GraphQL API's accept GraphQL queries which define what data the developer would like to access.</p>
<h3>Initialize the SDK</h3>
<p>This code example initializes the SDK. The <code>ShopifyBuy.Init</code> method takes two <code>strings</code>. The first <code>string</code> being an access token to communicate with the Storefront API. The second string is the domain name of your shop. </p><div class="fragment"><div class="line"><span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;351c122017d0f2a957d32ae728ad749c&quot;</span>;</div><div class="line"><span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;graphql.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">ShopifyBuy.Init(accessToken, shopDomain);</div></div><!-- fragment --><p> Once initialized you'll be using <code>ShopifyBuy.Client()</code> to query <a class="el" href="namespace_shopify.html">Shopify</a>. Initialization only needs to happen once.</p>
<h3>Query All Products</h3>
<p>The following example shows how to query all products in your <a class="el" href="namespace_shopify.html">Shopify</a> store. </p><div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;351c122017d0f2a957d32ae728ad749c&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;graphql.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    <span class="comment">// Init only needs to be called once</span></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    <span class="comment">// the following will query the shop for all products</span></div><div class="line">    ShopifyBuy.Client().products((products, errors, httpError) =&gt; {</div><div class="line">        <span class="comment">// httpError is actually Unity&#39;s WWW.error</span></div><div class="line">        <span class="keywordflow">if</span> (httpError != null) {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;There was an HTTP problem communicating with the API&quot;</span>);</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        <span class="comment">// it&#39;s unlikely but if an invalid GraphQL query was sent a List of errors will be returned</span></div><div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(errors != null) {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;There was an error with the graphql query sent&quot;</span>);</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// products is a List&lt;Product&gt;</span></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;Your shop has &quot;</span> + products.Count + <span class="stringliteral">&quot; products&quot;</span>);</div><div class="line">        Debug.Log(<span class="stringliteral">&quot;==================================================&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">foreach</span>(Product product <span class="keywordflow">in</span> products) {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Product Title: &quot;</span> + product.title());</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Product Description: &quot;</span> + product.descriptionHtml());</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;--------&quot;</span>);</div><div class="line">        }</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><h3>Query All Collections</h3>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;351c122017d0f2a957d32ae728ad749c&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;graphql.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    <span class="comment">// will query all collections on shop</span></div><div class="line">    ShopifyBuy.Client().collections((collections, errors, httpError) =&gt; {</div><div class="line">        <span class="keywordflow">if</span> (httpError != null) {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;There was an HTTP problem communicating with the API&quot;</span>);</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(errors != null) {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;There was an error with the graphql query sent&quot;</span>);</div><div class="line">            <span class="keywordflow">return</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">// collections is a List&lt;Collection&gt;</span></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;Your shop has &quot;</span> + collections.Count + <span class="stringliteral">&quot; collections&quot;</span>);</div><div class="line">        Debug.Log(<span class="stringliteral">&quot;==================================================&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">foreach</span>(Collection collection <span class="keywordflow">in</span> collections) {</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Collection title: &quot;</span> + collection.title());</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Collection updated at: &quot;</span> + collection.updatedAt());</div><div class="line"></div><div class="line">            List&lt;Product&gt; products = (List&lt;Product&gt;) collection.products();</div><div class="line"></div><div class="line">            <span class="keywordflow">foreach</span>(Product product <span class="keywordflow">in</span> products) {</div><div class="line">                Debug.Log(<span class="stringliteral">&quot;Collection contains a product with the following id: &quot;</span> + product.id());</div><div class="line">            }</div><div class="line">        }</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><p>It should be noted that in the above example if you were to call <code>product.title()</code> an Exception would be thrown. As stated in the begining of this document the Unity SDK is built on top of GraphQL queries. When <code>collections</code> are queried using this helper/utility method only <code>id</code> is queried on <code>Product</code>. To get an idea of what fields are queried checkout <code>DefaultQueries.cs</code>. We will discuss creating custom queries later.</p>
<h3>Cart + Web Checkout</h3>
<p>The following example will create a cart, add line items to the cart using product variants, and create a webcheckout link which will be opened in the Browser.</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;351c122017d0f2a957d32ae728ad749c&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;graphql.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    ShopifyBuy.Client().products((products, errors, httpError) =&gt; {</div><div class="line">        Cart cart = ShopifyBuy.Client().Cart();</div><div class="line"></div><div class="line">        List&lt;ProductVariant&gt; firstProductVariants = (List&lt;ProductVariant&gt;) products[0].variants();</div><div class="line">        List&lt;ProductVariant&gt; secondProductVariants = (List&lt;ProductVariant&gt;) products[1].variants();</div><div class="line">        ProductVariant firstProductFirstVariant = firstProductVariants[0];</div><div class="line">        ProductVariant secondProductFirstVariant = secondProductVariants[0];</div><div class="line"></div><div class="line">        <span class="comment">// the following example adds a line item using the first products first variant</span></div><div class="line">        <span class="comment">// in this case the cart will have 3 copies of the variant</span></div><div class="line">        cart.LineItems.AddOrUpdate(firstProductFirstVariant, 3);</div><div class="line"></div><div class="line">        <span class="comment">// AddOrUpdate is overloaded to accept ProductVariant&#39;s or strings or select a variant based on selected options</span></div><div class="line">        <span class="comment">// alternately you can use a product variant id string to create line items</span></div><div class="line">        <span class="comment">// this example adds 1 item to the cart</span></div><div class="line">        cart.LineItems.AddOrUpdate(secondProductFirstVariant.id(), 1);</div><div class="line"></div><div class="line">        <span class="comment">// the following line will get a checkout url using the above line items and open the url in browser</span></div><div class="line">        Application.OpenURL(cart.GetWebCheckoutLink());</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><p>To adjust or change quantity on a line item you could simply just call <code>AddOrUpdate</code> again with the new quantity. For instance from the above example if we wanted to adjust the quantity for <code>firstProductFirstVariant</code> to 1 we could call: </p><div class="fragment"><div class="line">cart.LineItems.AddOrUpdate(firstProductFirstVariant, 1);</div></div><!-- fragment --><p>To delete a line item do the following: </p><div class="fragment"><div class="line">cart.LineItems.Delete(firstProductFirstVariant);</div></div><!-- fragment --><p>To get a line item do the following: </p><div class="fragment"><div class="line">LineItemInput lineItem = cart.LineItems.Get(firstProductFirstVariant);</div></div><!-- fragment --><h3>Cart Line items based on selected options</h3>
<p>In <a class="el" href="namespace_shopify.html">Shopify</a> a product may have many options. These options map to variants of a product. The following example shows how to create Line items in a Cart based on selected options.</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;351c122017d0f2a957d32ae728ad749c&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;graphql.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    ShopifyBuy.Client().products((products, errors, httpError) =&gt; {</div><div class="line">        Cart cart = ShopifyBuy.Client().Cart();</div><div class="line"></div><div class="line">        Product firstProduct = products[0];</div><div class="line"></div><div class="line">        List&lt;ProductOption&gt; options = firstProduct.options();</div><div class="line"></div><div class="line">        <span class="comment">// we will output all options for this product</span></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;Options:\n-------&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">foreach</span>(ProductOption option <span class="keywordflow">in</span> options) {</div><div class="line">            <span class="comment">// Options have possible values</span></div><div class="line">            <span class="keywordflow">foreach</span>(<span class="keywordtype">string</span> value <span class="keywordflow">in</span> option.values()) {</div><div class="line">                <span class="comment">// Each option has a name such as Color and multiple values for color</span></div><div class="line">                Debug.Log(option.name() + <span class="stringliteral">&quot;: &quot;</span> + value);</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        Debug.Log(<span class="stringliteral">&quot;-------&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">// the following will create a dictionary where keys are option names and values are option values</span></div><div class="line">        <span class="comment">// you may for instance have drop downs for the user to select options from</span></div><div class="line">        Dictionary&lt;string,string&gt; selectedOptions = <span class="keyword">new</span> Dictionary&lt;string,string&gt;() {</div><div class="line">            {<span class="stringliteral">&quot;Size&quot;</span>, <span class="stringliteral">&quot;Large&quot;</span>},</div><div class="line">            {<span class="stringliteral">&quot;Color&quot;</span>, <span class="stringliteral">&quot;Green&quot;</span>}</div><div class="line">        };</div><div class="line"></div><div class="line">        <span class="comment">// create a line item based on the selected options for a product</span></div><div class="line">        cart.LineItems.AddOrUpdate(firstProduct, selectedOptions, 1);</div><div class="line"></div><div class="line">        <span class="comment">// checkout the selected product</span></div><div class="line">        Application.OpenURL(cart.GetWebCheckoutLink());</div><div class="line">    });</div><div class="line">}</div></div><!-- fragment --><p>If you'd like to <code>Delete</code> or <code>Get</code> a line item using do the following: </p><div class="fragment"><div class="line">cart.LineItems.Get(firstProduct, selectedOptions);</div><div class="line">cart.LineItems.Delete(firstProduct, selectedOptions);</div></div><!-- fragment --><h3>Custom Queries</h3>
<p>The Unity Buy SDK is built ontop of the Storefront API which is a GraphQL Web API. In GraphQL you send queries to the end point and receive back a JSON responses. Here's an example GraphQL query to get the name of a shop, and details about the billing address of the store:</p>
<div class="fragment"><div class="line">query {</div><div class="line">  shop {</div><div class="line">      name</div><div class="line">      billingAddress {</div><div class="line">          city</div><div class="line">          address1</div><div class="line">      }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>When this query is sent to the Storefront API the JSON response from the server would look like this: </p><div class="fragment"><div class="line">{</div><div class="line">  &quot;data&quot;: {</div><div class="line">    &quot;shop&quot;: {</div><div class="line">      &quot;name&quot;: &quot;graphql&quot;,</div><div class="line">      &quot;billingAddress&quot;: {</div><div class="line">        &quot;city&quot;: &quot;Toronto&quot;,</div><div class="line">        &quot;address1&quot;: &quot;80 Spadina Ave&quot;</div><div class="line">      }</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p> As you can see the data takes the same form as the query sent to the GraphQL endpoint. For more info on GraphQL checkout: <a href="http://graphql.org/">http://graphql.org/</a></p>
<p>In the previous examples when querying <code>products</code> and <code>collections</code> we were actually using utility functions on the <a class="el" href="namespace_shopify.html">Shopify</a> Buy client that generate generic queries that query data most people would expect to see on products and collections. It is possible to however build custom queries that can be sent to the Storefront API to access additional data.</p>
<p>In the following example we will build a query in C# which matches the GraphQL query mentioned above. Again we'll be querying:</p><ul>
<li>The shops <code>name</code></li>
<li>The shops <code>billingAddress</code><ul>
<li><code>city</code></li>
<li><code>address1</code></li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespace_shopify.html">Shopify</a>.<a class="code" href="namespace_shopify_1_1_unity.html">Unity</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Start () {</div><div class="line">    <span class="keywordtype">string</span> accessToken = <span class="stringliteral">&quot;351c122017d0f2a957d32ae728ad749c&quot;</span>;</div><div class="line">    <span class="keywordtype">string</span> shopDomain = <span class="stringliteral">&quot;graphql.myshopify.com&quot;</span>;</div><div class="line"></div><div class="line">    ShopifyBuy.Init(accessToken, shopDomain);</div><div class="line"></div><div class="line">    <span class="comment">// the following will build a custom query</span></div><div class="line">    <span class="comment">// this example uses named parameters but these could be omitted</span></div><div class="line">    ShopifyBuy.Client().Query(</div><div class="line">        <span class="comment">// pass a lambda expression to &#39;buildQuery&#39;</span></div><div class="line">        <span class="comment">// the lambda will receive a QueryRootQuery instance</span></div><div class="line">        buildQuery: (query) =&gt; query</div><div class="line">            .shop(shopQuery =&gt; shopQuery</div><div class="line">                .name()</div><div class="line">                .billingAddress(mailingAddressQuery =&gt; mailingAddressQuery</div><div class="line">                    .address1()</div><div class="line">                    .city()</div><div class="line">                )</div><div class="line">            ),</div><div class="line">        callback: (result, errors, httpError) =&gt; {</div><div class="line">            <span class="comment">// result is a QueryRoot instance</span></div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Shop name: &quot;</span> + result.shop().name());</div><div class="line">            Debug.Log(<span class="stringliteral">&quot;Shop city: &quot;</span> + result.shop().billingAddress().city());</div><div class="line">        }</div><div class="line">    );</div><div class="line">}</div></div><!-- fragment --><p>To create mutations you'd use <code>ShopifyBuy.Client().Mutation</code> in a similar fashion. </p>
</div></div><!-- contents -->
<address class="footer"><small>
    <a href="https://www.shopify.ca/">
        <img class="footer" height="50" src="https://camo.githubusercontent.com/10d580ddb06e6e6ff66ae43959842201195c6269/68747470733a2f2f63646e2e73686f706966792e636f6d2f73686f706966792d6d61726b6574696e675f6173736574732f6275696c64732f31392e302e302f73686f706966792d66756c6c2d636f6c6f722d626c61636b2e737667" alt="Shopify">
    </a>
</small></address>